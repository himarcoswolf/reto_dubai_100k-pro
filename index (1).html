<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>El Reto Dubai 100K - Live Tracking</title>
    <meta name="description" content="Sigue en tiempo real mi reto de 100K en Dubai">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
            overflow-x: hidden;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        
        @keyframes pulse-glow {
            0%, 100% { box-shadow: 0 0 20px rgba(6, 182, 212, 0.4); }
            50% { box-shadow: 0 0 40px rgba(6, 182, 212, 0.8); }
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes bob {
            0%, 100% { transform: translateY(0px); }
            25% { transform: translateY(-3px); }
            50% { transform: translateY(-5px); }
            75% { transform: translateY(-3px); }
        }
        
        .animate-float { animation: float 3s ease-in-out infinite; }
        .animate-pulse-glow { animation: pulse-glow 2s ease-in-out infinite; }
        .animate-slide-in { animation: slideIn 0.5s ease-out; }
        .animate-bob { animation: bob 2s ease-in-out infinite; }
        
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: rgba(0, 0, 0, 0.3); }
        ::-webkit-scrollbar-thumb { background: rgba(6, 182, 212, 0.5); border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: rgba(6, 182, 212, 0.7); }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        const START_DATE = new Date('2025-11-01T00:00:00+04:00');
        const GOAL = 100000;
        const INITIAL_BUDGET = 10000;
        const ADMIN_PASSWORD = 'Dubai2025!';

        const LOCATIONS = {
            oficina: { id: 'oficina', name: 'üè¢ Oficina', icon: 'üè¢', color: 'from-blue-500 to-cyan-500', defaultActivity: 'Trabajando en mi escritorio' },
            gimnasio: { id: 'gimnasio', name: 'üí™ Gimnasio', icon: 'üí™', color: 'from-orange-500 to-red-500', defaultActivity: 'Entrenamiento' },
            casa: { id: 'casa', name: 'üè† Casa', icon: 'üè†', color: 'from-purple-500 to-pink-500', defaultActivity: 'Descansando' },
            reunion: { id: 'reunion', name: 'ü§ù Reuni√≥n', icon: 'ü§ù', color: 'from-green-500 to-emerald-500', defaultActivity: 'Reuni√≥n con cliente' },
            mall: { id: 'mall', name: 'üèôÔ∏è Dubai Mall', icon: 'üèôÔ∏è', color: 'from-yellow-500 to-orange-500', defaultActivity: 'Networking' },
            aeropuerto: { id: 'aeropuerto', name: '‚úàÔ∏è Aeropuerto', icon: '‚úàÔ∏è', color: 'from-sky-500 to-blue-500', defaultActivity: 'Viajando' },
            restaurante: { id: 'restaurante', name: 'üçΩÔ∏è Restaurante', icon: 'üçΩÔ∏è', color: 'from-amber-500 to-orange-500', defaultActivity: 'Comida de negocios' }
        };

        // Componentes de escenas SVG
        const OficinaScene = () => (
            <svg viewBox="0 0 400 300" className="w-full h-auto max-w-2xl mx-auto">
                <polygon points="200,250 100,200 200,150 300,200" fill="#3b4252" stroke="#4c566a" strokeWidth="2"/>
                <polygon points="180,180 220,180 230,190 170,190" fill="#5e81ac" stroke="#4c566a" strokeWidth="1.5"/>
                <polygon points="170,190 230,190 230,200 170,200" fill="#81a1c1" stroke="#4c566a" strokeWidth="1.5"/>
                <rect x="190" y="165" width="20" height="15" fill="#2e3440" stroke="#4c566a" strokeWidth="1"/>
                <rect x="192" y="167" width="16" height="11" fill="#06b6d4"/>
                <ellipse cx="200" cy="210" rx="12" ry="6" fill="#88c0d0"/>
                <line x1="200" y1="210" x2="200" y2="225" stroke="#4c566a" strokeWidth="2"/>
                <circle cx="200" cy="195" r="8" fill="#f97316" className="animate-bob"/>
                <ellipse cx="200" cy="205" rx="10" ry="5" fill="#3b82f6" className="animate-bob"/>
                <line x1="195" y1="200" x2="190" y2="185" stroke="#f97316" strokeWidth="2" className="animate-bob"/>
                <line x1="205" y1="200" x2="210" y2="185" stroke="#f97316" strokeWidth="2" className="animate-bob"/>
                <ellipse cx="250" cy="195" rx="8" ry="4" fill="#5e81ac"/>
                <circle cx="250" cy="188" r="6" fill="#a3be8c"/>
                <line x1="160" y1="175" x2="160" y2="160" stroke="#4c566a" strokeWidth="2"/>
                <polygon points="155,160 165,160 162,155" fill="#ebcb8b"/>
            </svg>
        );

        const GimnasioScene = () => (
            <svg viewBox="0 0 400 300" className="w-full h-auto max-w-2xl mx-auto">
                <polygon points="200,250 100,200 200,150 300,200" fill="#3b4252" stroke="#4c566a" strokeWidth="2"/>
                <polygon points="160,190 240,190 250,200 150,200" fill="#4c566a" stroke="#2e3440" strokeWidth="1.5"/>
                <polygon points="150,200 250,200 250,205 150,205" fill="#5e81ac" stroke="#2e3440" strokeWidth="1"/>
                <rect x="175" y="175" width="50" height="8" fill="#434c5e" stroke="#2e3440" strokeWidth="1"/>
                <circle cx="180" cy="179" r="3" fill="#d08770"/>
                <circle cx="220" cy="179" r="3" fill="#d08770"/>
                <circle cx="200" cy="182" r="9" fill="#f97316" className="animate-bob"/>
                <ellipse cx="200" cy="193" rx="11" ry="6" fill="#3b82f6" className="animate-bob"/>
                <line x1="195" y1="199" x2="190" y2="210" stroke="#3b82f6" strokeWidth="3" className="animate-bob"/>
                <line x1="205" y1="199" x2="210" y2="210" stroke="#3b82f6" strokeWidth="3" className="animate-bob"/>
                <line x1="193" y1="188" x2="185" y2="180" stroke="#f97316" strokeWidth="2.5" className="animate-bob"/>
                <line x1="207" y1="188" x2="215" y2="195" stroke="#f97316" strokeWidth="2.5" className="animate-bob"/>
                <rect x="270" y="200" width="15" height="6" fill="#434c5e"/>
                <circle cx="272" cy="203" r="4" fill="#d08770"/>
                <circle cx="283" cy="203" r="4" fill="#d08770"/>
                <rect x="120" y="165" width="30" height="35" fill="#88c0d0" opacity="0.3" stroke="#4c566a" strokeWidth="1"/>
            </svg>
        );

        const CasaScene = ({sleeping}) => (
            <svg viewBox="0 0 400 300" className="w-full h-auto max-w-2xl mx-auto">
                <polygon points="200,250 100,200 200,150 300,200" fill="#3b4252" stroke="#4c566a" strokeWidth="2"/>
                <polygon points="160,190 240,190 250,200 150,200" fill="#5e81ac" stroke="#4c566a" strokeWidth="1.5"/>
                <polygon points="150,200 250,200 250,208 150,208" fill="#81a1c1" stroke="#4c566a" strokeWidth="1.5"/>
                <ellipse cx="180" cy="195" rx="15" ry="8" fill="#d8dee9"/>
                {sleeping ? (
                    <>
                        <ellipse cx="190" cy="197" rx="20" ry="10" fill="#f97316"/>
                        <circle cx="175" cy="194" r="6" fill="#f97316"/>
                        <text x="200" y="192" fontSize="12" fill="#ebcb8b">üí§</text>
                    </>
                ) : (
                    <>
                        <circle cx="190" cy="190" r="8" fill="#f97316"/>
                        <ellipse cx="190" cy="200" rx="10" ry="6" fill="#3b82f6"/>
                        <line x1="185" y1="195" x2="180" y2="200" stroke="#f97316" strokeWidth="2"/>
                        <line x1="195" y1="195" x2="200" y2="200" stroke="#f97316" strokeWidth="2"/>
                    </>
                )}
                <polygon points="260,195 280,195 285,205 255,205" fill="#5e81ac" stroke="#4c566a" strokeWidth="1"/>
                <line x1="270" y1="195" x2="270" y2="185" stroke="#4c566a" strokeWidth="2"/>
                <polygon points="265,185 275,185 270,180" fill="#ebcb8b"/>
                <rect x="120" y="170" width="25" height="30" fill="#88c0d0" opacity="0.4" stroke="#4c566a" strokeWidth="1.5"/>
                <line x1="132.5" y1="170" x2="132.5" y2="200" stroke="#4c566a" strokeWidth="1"/>
                <line x1="120" y1="185" x2="145" y2="185" stroke="#4c566a" strokeWidth="1"/>
            </svg>
        );

        const ReunionScene = () => (
            <svg viewBox="0 0 400 300" className="w-full h-auto max-w-2xl mx-auto">
                <polygon points="200,250 100,200 200,150 300,200" fill="#3b4252" stroke="#4c566a" strokeWidth="2"/>
                <ellipse cx="200" cy="200" rx="60" ry="25" fill="#5e81ac" stroke="#4c566a" strokeWidth="2"/>
                <rect x="185" y="190" width="12" height="8" fill="#d8dee9" stroke="#4c566a" strokeWidth="0.5"/>
                <rect x="210" y="188" width="15" height="10" fill="#d8dee9" stroke="#4c566a" strokeWidth="0.5"/>
                <rect x="170" y="192" width="15" height="10" fill="#2e3440" stroke="#4c566a" strokeWidth="1"/>
                <rect x="172" y="194" width="11" height="6" fill="#06b6d4"/>
                <circle cx="200" cy="175" r="9" fill="#f97316" className="animate-bob"/>
                <ellipse cx="200" cy="187" rx="12" ry="6" fill="#2e3440" className="animate-bob"/>
                <line x1="194" y1="182" x2="185" y2="178" stroke="#f97316" strokeWidth="2.5" className="animate-bob"/>
                <line x1="206" y1="182" x2="215" y2="178" stroke="#f97316" strokeWidth="2.5" className="animate-bob"/>
                <circle cx="220" cy="182" r="7" fill="#88c0d0" opacity="0.6"/>
                <ellipse cx="220" cy="192" rx="9" ry="5" fill="#5e81ac" opacity="0.6"/>
                <rect x="160" y="155" width="35" height="25" fill="#4c566a" stroke="#2e3440" strokeWidth="1.5"/>
                <line x1="165" y1="162" x2="185" y2="162" stroke="#a3be8c" strokeWidth="1"/>
                <line x1="165" y1="168" x2="190" y2="168" stroke="#81a1c1" strokeWidth="1"/>
                <line x1="165" y1="174" x2="180" y2="174" stroke="#bf616a" strokeWidth="1"/>
            </svg>
        );

        const MallScene = () => (
            <svg viewBox="0 0 400 300" className="w-full h-auto max-w-2xl mx-auto">
                <polygon points="200,250 100,200 200,150 300,200" fill="#d8dee9" stroke="#4c566a" strokeWidth="2"/>
                <line x1="150" y1="175" x2="250" y2="225" stroke="#eceff4" strokeWidth="1"/>
                <line x1="170" y1="165" x2="270" y2="215" stroke="#eceff4" strokeWidth="1"/>
                <rect x="120" y="160" width="30" height="40" fill="#5e81ac" stroke="#4c566a" strokeWidth="1.5"/>
                <rect x="250" y="160" width="30" height="40" fill="#81a1c1" stroke="#4c566a" strokeWidth="1.5"/>
                <rect x="125" y="170" width="20" height="15" fill="#88c0d0" opacity="0.5"/>
                <rect x="255" y="170" width="20" height="15" fill="#88c0d0" opacity="0.5"/>
                <circle cx="200" cy="190" r="9" fill="#f97316" className="animate-bob"/>
                <ellipse cx="200" cy="202" rx="11" ry="6" fill="#3b82f6" className="animate-bob"/>
                <line x1="196" y1="208" x2="193" y2="218" stroke="#3b82f6" strokeWidth="2.5" className="animate-bob"/>
                <line x1="204" y1="208" x2="207" y2="218" stroke="#3b82f6" strokeWidth="2.5" className="animate-bob"/>
                <line x1="194" y1="196" x2="188" y2="200" stroke="#f97316" strokeWidth="2" className="animate-bob"/>
                <line x1="206" y1="196" x2="212" y2="192" stroke="#f97316" strokeWidth="2" className="animate-bob"/>
                <rect x="210" y="196" width="8" height="10" fill="#d08770" stroke="#2e3440" strokeWidth="1"/>
                <line x1="212" y1="196" x2="216" y2="196" stroke="#2e3440" strokeWidth="1.5"/>
                <ellipse cx="165" cy="210" rx="6" ry="3" fill="#5e81ac"/>
                <circle cx="165" cy="205" r="5" fill="#a3be8c"/>
                <ellipse cx="235" cy="210" rx="6" ry="3" fill="#5e81ac"/>
                <circle cx="235" cy="205" r="5" fill="#a3be8c"/>
            </svg>
        );

        const AeropuertoScene = () => (
            <svg viewBox="0 0 400 300" className="w-full h-auto max-w-2xl mx-auto">
                <polygon points="200,250 100,200 200,150 300,200" fill="#3b4252" stroke="#4c566a" strokeWidth="2"/>
                <rect x="175" y="200" width="20" height="25" fill="#d08770" stroke="#2e3440" strokeWidth="1.5"/>
                <rect x="177" y="202" width="16" height="3" fill="#bf616a"/>
                <line x1="185" y1="200" x2="185" y2="195" stroke="#2e3440" strokeWidth="2"/>
                <circle cx="185" cy="193" r="2" fill="#2e3440"/>
                <circle cx="205" cy="185" r="9" fill="#f97316" className="animate-bob"/>
                <ellipse cx="205" cy="197" rx="11" ry="6" fill="#3b82f6" className="animate-bob"/>
                <line x1="199" y1="192" x2="187" y2="198" stroke="#f97316" strokeWidth="2.5" className="animate-bob"/>
                <line x1="211" y1="192" x2="220" y2="195" stroke="#f97316" strokeWidth="2.5" className="animate-bob"/>
                <ellipse cx="250" cy="170" rx="25" ry="8" fill="#81a1c1" stroke="#4c566a" strokeWidth="1"/>
                <polygon points="225,170 235,165 235,175" fill="#88c0d0"/>
                <polygon points="265,168 275,165 275,172" fill="#88c0d0"/>
                <circle cx="245" cy="168" r="3" fill="#2e3440"/>
                <circle cx="255" cy="168" r="3" fill="#2e3440"/>
                <rect x="130" y="165" width="30" height="20" fill="#2e3440" stroke="#4c566a" strokeWidth="1.5"/>
                <text x="135" y="177" fontSize="8" fill="#06b6d4">GATE</text>
                <text x="138" y="186" fontSize="10" fill="#a3be8c">B23</text>
                <rect x="270" y="195" width="20" height="8" fill="#5e81ac" stroke="#4c566a" strokeWidth="1"/>
            </svg>
        );

        const RestauranteScene = () => (
            <svg viewBox="0 0 400 300" className="w-full h-auto max-w-2xl mx-auto">
                <polygon points="200,250 100,200 200,150 300,200" fill="#3b4252" stroke="#4c566a" strokeWidth="2"/>
                <ellipse cx="200" cy="205" rx="40" ry="20" fill="#5e81ac" stroke="#4c566a" strokeWidth="2"/>
                <ellipse cx="200" cy="205" rx="35" ry="17" fill="#d8dee9" stroke="#4c566a" strokeWidth="0.5"/>
                <ellipse cx="190" cy="198" rx="8" ry="4" fill="#eceff4" stroke="#4c566a" strokeWidth="0.8"/>
                <circle cx="190" cy="196" r="5" fill="#d08770"/>
                <ellipse cx="215" cy="200" rx="8" ry="4" fill="#eceff4" stroke="#4c566a" strokeWidth="0.8"/>
                <circle cx="215" cy="198" r="5" fill="#a3be8c"/>
                <ellipse cx="180" cy="202" rx="3" ry="2" fill="#88c0d0" stroke="#4c566a" strokeWidth="0.5"/>
                <polygon points="178,202 182,202 180,195" fill="#88c0d0" opacity="0.6" stroke="#4c566a" strokeWidth="0.5"/>
                <ellipse cx="208" cy="204" rx="3" ry="2" fill="#88c0d0" stroke="#4c566a" strokeWidth="0.5"/>
                <polygon points="206,204 210,204 208,197" fill="#88c0d0" opacity="0.6" stroke="#4c566a" strokeWidth="0.5"/>
                <circle cx="200" cy="180" r="9" fill="#f97316" className="animate-bob"/>
                <ellipse cx="200" cy="192" rx="12" ry="6" fill="#2e3440" className="animate-bob"/>
                <line x1="195" y1="186" x2="188" y2="195" stroke="#f97316" strokeWidth="2" className="animate-bob"/>
                <line x1="205" y1="186" x2="215" y2="193" stroke="#f97316" strokeWidth="2" className="animate-bob"/>
                <circle cx="220" cy="185" r="7" fill="#88c0d0" opacity="0.6"/>
                <ellipse cx="220" cy="195" rx="9" ry="5" fill="#5e81ac" opacity="0.6"/>
                <rect x="198" y="200" width="4" height="6" fill="#ebcb8b"/>
                <ellipse cx="200" cy="200" rx="2" ry="1" fill="#d08770"/>
                <rect x="150" y="160" width="20" height="25" fill="#5e81ac" stroke="#4c566a" strokeWidth="1"/>
                <circle cx="160" cy="172" r="6" fill="#a3be8c"/>
            </svg>
        );

        const SimsApp = () => {
            const [data, setData] = useState({
                totalIngresos: 0,
                totalGastos: 0,
                ingresosPorCategoria: { asesoria: 0, realEstate: 0, inversiones: 0 },
                actualizaciones: [],
                mensajes: [],
                visitantes: 0,
                logrosDesbloqueados: [],
                currentLocation: 'casa',
                currentActivity: 'Prepar√°ndome para el d√≠a',
                locationChangedAt: new Date().toISOString(),
                isAutoSleeping: false
            });

            const [showAdmin, setShowAdmin] = useState(false);
            const [isAuthenticated, setIsAuthenticated] = useState(false);
            const [adminPassword, setAdminPassword] = useState('');
            const [showLogrosDetail, setShowLogrosDetail] = useState(false);
            const [newMessage, setNewMessage] = useState('');
            
            const [activityForm, setActivityForm] = useState({ location: 'oficina', activity: '' });
            const [financeForm, setFinanceForm] = useState({ categoria: 'asesoria', monto: '', tipo: 'ingreso', nota: '' });

            useEffect(() => {
                const savedData = localStorage.getItem('simsRetoData');
                if (savedData) setData(JSON.parse(savedData));
                
                const currentVisits = parseInt(localStorage.getItem('visitCount') || '0');
                localStorage.setItem('visitCount', (currentVisits + 1).toString());
                setData(prev => ({ ...prev, visitantes: currentVisits + 1 }));
            }, []);

            useEffect(() => {
                localStorage.setItem('simsRetoData', JSON.stringify(data));
            }, [data]);

            useEffect(() => {
                const checkAutoSchedule = () => {
                    const now = new Date();
                    const dubaiTime = new Date(now.toLocaleString('en-US', { timeZone: 'Asia/Dubai' }));
                    const hour = dubaiTime.getHours();

                    if (hour >= 23 || hour < 7) {
                        if (!data.isAutoSleeping) {
                            setData(prev => ({
                                ...prev,
                                currentLocation: 'casa',
                                currentActivity: 'üò¥ Durmiendo',
                                locationChangedAt: new Date().toISOString(),
                                isAutoSleeping: true
                            }));
                        }
                    } else if (hour === 7 && data.isAutoSleeping) {
                        setData(prev => ({
                            ...prev,
                            currentLocation: 'casa',
                            currentActivity: '‚òÄÔ∏è Buenos d√≠as!',
                            locationChangedAt: new Date().toISOString(),
                            isAutoSleeping: false
                        }));
                    }
                };

                checkAutoSchedule();
                const interval = setInterval(checkAutoSchedule, 60000);
                return () => clearInterval(interval);
            }, [data.isAutoSleeping]);

            const getTimeInLocation = () => {
                const now = new Date();
                const changedAt = new Date(data.locationChangedAt);
                const diffMs = now - changedAt;
                const diffMins = Math.floor(diffMs / 60000);
                const diffHours = Math.floor(diffMins / 60);
                const remainingMins = diffMins % 60;
                if (diffHours > 0) return `${diffHours}h ${remainingMins}m`;
                return `${diffMins}m`;
            };

            const getDaysElapsed = () => {
                const now = new Date();
                const diff = now - START_DATE;
                return Math.floor(diff / (1000 * 60 * 60 * 24));
            };

            const progreso = (data.totalIngresos / GOAL) * 100;
            const budgetRestante = INITIAL_BUDGET - data.totalGastos;
            const progressoBudget = (budgetRestante / INITIAL_BUDGET) * 100;

            useEffect(() => {
                const nuevosLogros = [];
                if (data.totalIngresos >= 25000 && !data.logrosDesbloqueados.includes('25k')) nuevosLogros.push('25k');
                if (data.totalIngresos >= 50000 && !data.logrosDesbloqueados.includes('50k')) nuevosLogros.push('50k');
                if (data.totalIngresos >= 75000 && !data.logrosDesbloqueados.includes('75k')) nuevosLogros.push('75k');
                
                if (nuevosLogros.length > 0) {
                    setData(prev => ({
                        ...prev,
                        logrosDesbloqueados: [...prev.logrosDesbloqueados, ...nuevosLogros]
                    }));
                }
            }, [data.totalIngresos]);

            const handleAdminLogin = (e) => {
                e.preventDefault();
                if (adminPassword === ADMIN_PASSWORD) {
                    setIsAuthenticated(true);
                } else {
                    alert('Contrase√±a incorrecta');
                }
            };

            const handleActivityUpdate = (e) => {
                e.preventDefault();
                const location = LOCATIONS[activityForm.location];
                const activity = activityForm.activity.trim() || location.defaultActivity;

                setData(prev => ({
                    ...prev,
                    currentLocation: activityForm.location,
                    currentActivity: activity,
                    locationChangedAt: new Date().toISOString(),
                    isAutoSleeping: false
                }));

                setActivityForm({ location: 'oficina', activity: '' });
                alert('¬°Ubicaci√≥n actualizada!');
            };

            const handleFinanceUpdate = (e) => {
                e.preventDefault();
                const monto = parseFloat(financeForm.monto);
                
                if (isNaN(monto) || monto <= 0) {
                    alert('Introduce un monto v√°lido');
                    return;
                }

                const nuevaActualizacion = {
                    fecha: new Date().toISOString(),
                    categoria: financeForm.categoria,
                    monto: monto,
                    tipo: financeForm.tipo,
                    nota: financeForm.nota
                };

                setData(prev => {
                    const newData = { ...prev };
                    
                    if (financeForm.tipo === 'ingreso') {
                        newData.totalIngresos += monto;
                        newData.ingresosPorCategoria[financeForm.categoria] += monto;
                    } else {
                        newData.totalGastos += monto;
                    }
                    
                    newData.actualizaciones = [nuevaActualizacion, ...newData.actualizaciones];
                    return newData;
                });

                setFinanceForm({ categoria: 'asesoria', monto: '', tipo: 'ingreso', nota: '' });
                alert('¬°Actualizaci√≥n guardada!');
            };

            const handleNewMessage = (e) => {
                e.preventDefault();
                
                const palabrasProhibidas = ['idiota', 'tonto', 'est√∫pido', 'estupido', 'basura', 'mierda', 'hate', 'odio'];
                let textoLimpio = newMessage.toLowerCase();
                
                for (let palabra of palabrasProhibidas) {
                    if (textoLimpio.includes(palabra)) {
                        alert('Mensaje contiene contenido no permitido. Mantengamos el ambiente positivo üí™');
                        return;
                    }
                }

                if (newMessage.trim().length < 3) {
                    alert('Mensaje muy corto');
                    return;
                }

                const mensaje = {
                    id: Date.now(),
                    texto: newMessage,
                    fecha: new Date().toISOString(),
                    usuario: 'An√≥nimo'
                };

                setData(prev => ({
                    ...prev,
                    mensajes: [mensaje, ...prev.mensajes].slice(0, 50)
                }));

                setNewMessage('');
            };

            const renderScene = () => {
                switch(data.currentLocation) {
                    case 'oficina': return <OficinaScene />;
                    case 'gimnasio': return <GimnasioScene />;
                    case 'casa': return <CasaScene sleeping={data.isAutoSleeping} />;
                    case 'reunion': return <ReunionScene />;
                    case 'mall': return <MallScene />;
                    case 'aeropuerto': return <AeropuertoScene />;
                    case 'restaurante': return <RestauranteScene />;
                    default: return <OficinaScene />;
                }
            };

            const currentLocation = LOCATIONS[data.currentLocation];

            return (
                <div className="min-h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-slate-900 text-white">
                    {/* Header */}
                    <div className="bg-black/50 backdrop-blur-md border-b border-cyan-500/30 p-4 sticky top-0 z-50">
                        <div className="max-w-6xl mx-auto flex justify-between items-center">
                            <div>
                                <h1 className="text-xl font-bold bg-gradient-to-r from-cyan-400 to-orange-500 bg-clip-text text-transparent">
                                    ‚ö° EL RETO DUBAI 100K - LIVE
                                </h1>
                                <p className="text-xs text-cyan-400/70">S√≠gueme en tiempo real</p>
                            </div>
                            <div className="flex items-center gap-4">
                                <div className="text-right">
                                    <div className="text-xs text-gray-400">D√≠a #{getDaysElapsed()}</div>
                                    <div className="text-xs text-orange-400">üëÅÔ∏è {data.visitantes.toLocaleString()}</div>
                                </div>
                                <button onClick={() => setShowAdmin(!showAdmin)} className="text-cyan-400 hover:text-cyan-300 p-2 rounded-lg hover:bg-cyan-500/10 transition-all">üîí</button>
                            </div>
                        </div>
                    </div>

                    <div className="max-w-6xl mx-auto px-4 py-6">
                        {/* Stats superiores */}
                        <div className="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                            <div className="bg-gradient-to-br from-cyan-500/10 to-blue-500/10 border border-cyan-500/30 rounded-lg p-4 text-center">
                                <div className="text-sm text-cyan-400 mb-1">üí∞ Ganado</div>
                                <div className="text-2xl font-bold text-cyan-400">{data.totalIngresos.toLocaleString('es-ES')}‚Ç¨</div>
                                <div className="text-xs text-gray-400 mt-1">{progreso.toFixed(1)}% de 100K</div>
                            </div>
                            
                            <div className="bg-gradient-to-br from-orange-500/10 to-red-500/10 border border-orange-500/30 rounded-lg p-4 text-center">
                                <div className="text-sm text-orange-400 mb-1">üí∏ Quedan</div>
                                <div className="text-2xl font-bold text-orange-400">{budgetRestante.toLocaleString('es-ES')}‚Ç¨</div>
                                <div className="text-xs text-gray-400 mt-1">{progressoBudget.toFixed(0)}% restante</div>
                            </div>
                            
                            <div className="bg-gradient-to-br from-yellow-500/10 to-orange-500/10 border border-yellow-500/30 rounded-lg p-4 text-center cursor-pointer hover:from-yellow-500/20 hover:to-orange-500/20 transition-all" onClick={() => setShowLogrosDetail(!showLogrosDetail)}>
                                <div className="text-sm text-yellow-400 mb-1">üèÜ Logros</div>
                                <div className="text-2xl font-bold text-yellow-400">{data.logrosDesbloqueados.length}/3</div>
                                <div className="text-xs text-gray-400 mt-1">Click para ver detalles</div>
                            </div>
                        </div>

                        {/* Detalle de logros expandible */}
                        {showLogrosDetail && (
                            <div className="bg-gradient-to-r from-yellow-500/10 to-orange-500/10 border border-yellow-500/30 rounded-xl p-6 mb-6 animate-slide-in">
                                <h3 className="text-lg font-bold text-yellow-400 mb-4 flex items-center justify-between">
                                    <span>üèÜ Detalle de Logros</span>
                                    <button onClick={() => setShowLogrosDetail(false)} className="text-sm text-gray-400 hover:text-white">‚úï</button>
                                </h3>
                                <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                                    <div className={`p-4 rounded-lg border ${data.logrosDesbloqueados.includes('25k') ? 'bg-yellow-500/20 border-yellow-500/50' : 'bg-black/30 border-gray-700'}`}>
                                        <div className="text-3xl mb-2">{data.logrosDesbloqueados.includes('25k') ? 'üèÜ' : 'üîí'}</div>
                                        <div className="font-bold">25.000‚Ç¨</div>
                                        <div className="text-xs text-gray-400 mt-1">{data.logrosDesbloqueados.includes('25k') ? '¬°Desbloqueado!' : `Faltan ${(25000 - data.totalIngresos).toLocaleString()}‚Ç¨`}</div>
                                    </div>
                                    <div className={`p-4 rounded-lg border ${data.logrosDesbloqueados.includes('50k') ? 'bg-cyan-500/20 border-cyan-500/50' : 'bg-black/30 border-gray-700'}`}>
                                        <div className="text-3xl mb-2">{data.logrosDesbloqueados.includes('50k') ? 'üíé' : 'üîí'}</div>
                                        <div className="font-bold">50.000‚Ç¨</div>
                                        <div className="text-xs text-gray-400 mt-1">{data.logrosDesbloqueados.includes('50k') ? '¬°Desbloqueado!' : data.totalIngresos >= 25000 ? `Faltan ${(50000 - data.totalIngresos).toLocaleString()}‚Ç¨` : 'Desbloquea 25K primero'}</div>
                                    </div>
                                    <div className={`p-4 rounded-lg border ${data.logrosDesbloqueados.includes('75k') ? 'bg-purple-500/20 border-purple-500/50' : 'bg-black/30 border-gray-700'}`}>
                                        <div className="text-3xl mb-2">{data.logrosDesbloqueados.includes('75k') ? 'üëë' : 'üîí'}</div>
                                        <div className="font-bold">75.000‚Ç¨</div>
                                        <div className="text-xs text-gray-400 mt-1">{data.logrosDesbloqueados.includes('75k') ? '¬°Desbloqueado!' : data.totalIngresos >= 50000 ? `Faltan ${(75000 - data.totalIngresos).toLocaleString()}‚Ç¨` : 'Desbloquea 50K primero'}</div>
                                    </div>
                                </div>
                            </div>
                        )}

                        {/* Barras de progreso */}
                        <div className="mb-6">
                            <div className="mb-4">
                                <div className="flex justify-between items-center mb-2">
                                    <span className="text-sm font-semibold text-cyan-400">META: 100.000‚Ç¨</span>
                                    <span className="text-xl font-bold text-cyan-400">{data.totalIngresos.toLocaleString('es-ES')}‚Ç¨</span>
                                </div>
                                <div className="h-8 bg-black/50 rounded-full border border-cyan-500/30 overflow-hidden relative">
                                    <div className="h-full bg-gradient-to-r from-cyan-500 via-blue-500 to-cyan-400 transition-all duration-1000" style={{ width: `${progreso}%` }}>
                                        <div className="absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent animate-pulse" />
                                    </div>
                                    <div className="absolute inset-0 flex items-center justify-center text-xs font-bold text-white drop-shadow-lg">
                                        {progreso.toFixed(1)}% completado
                                    </div>
                                </div>
                            </div>
                            
                            <div>
                                <div className="flex justify-between items-center mb-2">
                                    <span className="text-sm font-semibold text-orange-400">PRESUPUESTO RESTANTE</span>
                                    <span className={`text-xl font-bold ${budgetRestante < 3000 ? 'text-red-500 animate-pulse' : 'text-orange-400'}`}>
                                        {budgetRestante.toLocaleString('es-ES')}‚Ç¨
                                    </span>
                                </div>
                                <div className="h-6 bg-black/50 rounded-full border border-orange-500/30 overflow-hidden relative">
                                    <div className={`h-full transition-all duration-1000 ${budgetRestante < 3000 ? 'bg-gradient-to-r from-red-600 to-red-500 animate-pulse' : 'bg-gradient-to-r from-orange-600 to-orange-400'}`} style={{ width: `${progressoBudget}%` }} />
                                    <div className="absolute inset-0 flex items-center justify-center text-xs font-bold text-white drop-shadow-lg">
                                        {progressoBudget.toFixed(0)}%
                                    </div>
                                </div>
                            </div>
                        </div>

                        {/* Ubicaci√≥n actual */}
                        <div className={`bg-gradient-to-br ${currentLocation.color} p-1 rounded-xl mb-6 animate-pulse-glow`}>
                            <div className="bg-slate-900/90 backdrop-blur-sm rounded-lg p-6">
                                <div className="flex flex-col md:flex-row items-start md:items-center justify-between gap-4 mb-4">
                                    <div>
                                        <div className="text-sm text-gray-400 mb-1">üìç Marcos est√° ahora en:</div>
                                        <div className="text-3xl font-bold flex items-center gap-3">
                                            <span>{currentLocation.icon}</span>
                                            <span>{currentLocation.name}</span>
                                        </div>
                                    </div>
                                    <div className="text-right">
                                        <div className="text-sm text-gray-400">‚è±Ô∏è Hace</div>
                                        <div className="text-2xl font-bold text-cyan-400">{getTimeInLocation()}</div>
                                    </div>
                                </div>
                                <div className="bg-black/30 rounded-lg p-3 border border-white/10">
                                    <div className="text-sm text-gray-400 mb-1">üí¨ Actividad:</div>
                                    <div className="text-lg font-semibold">{data.currentActivity}</div>
                                </div>
                            </div>
                        </div>

                        {/* Escena Sims */}
                        <div className="bg-gradient-to-br from-slate-800/50 to-slate-900/50 backdrop-blur-sm border-2 border-cyan-500/30 rounded-xl p-6 mb-6">
                            <div className="relative w-full min-h-[400px] flex items-center justify-center overflow-hidden rounded-xl">
                                <div className="absolute inset-0 opacity-10">
                                    <svg width="100%" height="100%" xmlns="http://www.w3.org/2000/svg">
                                        <defs>
                                            <pattern id="isoGrid" x="0" y="0" width="40" height="40" patternUnits="userSpaceOnUse">
                                                <path d="M 40 0 L 0 20 L 0 21 L 40 1 Z" fill="none" stroke="currentColor" strokeWidth="0.5" className="text-cyan-400"/>
                                                <path d="M 0 20 L 40 40 L 40 39 L 0 19 Z" fill="none" stroke="currentColor" strokeWidth="0.5" className="text-cyan-400"/>
                                            </pattern>
                                        </defs>
                                        <rect width="100%" height="100%" fill="url(#isoGrid)" />
                                    </svg>
                                </div>
                                <div className="relative z-10">
                                    {renderScene()}
                                </div>
                            </div>
                        </div>

                        {/* Grid 2 columnas */}
                        <div className="grid md:grid-cols-2 gap-6 mb-6">
                            <div className="bg-gradient-to-br from-cyan-500/10 to-blue-500/10 border border-cyan-500/30 rounded-xl p-6">
                                <h3 className="text-lg font-bold text-cyan-400 mb-4">üìä √öltimas Actualizaciones</h3>
                                <div className="space-y-3 max-h-64 overflow-y-auto">
                                    {data.actualizaciones.length === 0 ? (
                                        <p className="text-center text-gray-500 py-8">A√∫n no hay actualizaciones</p>
                                    ) : (
                                        data.actualizaciones.slice(0, 5).map((act, idx) => (
                                            <div key={idx} className="bg-black/30 rounded-lg p-3 border border-cyan-500/20">
                                                <div className="flex justify-between items-start mb-1">
                                                    <span className={`font-bold ${act.tipo === 'ingreso' ? 'text-green-400' : 'text-red-400'}`}>
                                                        {act.tipo === 'ingreso' ? '+' : '-'}{act.monto.toLocaleString('es-ES')}‚Ç¨
                                                    </span>
                                                    <span className="text-xs text-gray-500">
                                                        {new Date(act.fecha).toLocaleDateString('es-ES', { day: 'numeric', month: 'short' })}
                                                    </span>
                                                </div>
                                                <div className="text-xs text-gray-400">
                                                    {act.categoria === 'asesoria' ? 'üíº Asesoramiento' : 
                                                     act.categoria === 'realEstate' ? 'üè¢ Real Estate' : 
                                                     act.categoria === 'inversiones' ? 'üìä Inversiones' : 'üí∏ Gastos'}
                                                </div>
                                                {act.nota && <div className="text-xs text-gray-300 mt-1">{act.nota}</div>}
                                            </div>
                                        ))
                                    )}
                                </div>
                            </div>

                            <div className="bg-gradient-to-br from-green-500/10 to-emerald-500/10 border border-green-500/30 rounded-xl p-6">
                                <h3 className="text-lg font-bold text-green-400 mb-4">üí∞ Desglose de Ingresos</h3>
                                <div className="space-y-4">
                                    <div className="flex justify-between items-center p-3 bg-black/30 rounded-lg">
                                        <span className="text-gray-300">üíº Asesoramiento</span>
                                        <span className="font-bold text-cyan-400">{data.ingresosPorCategoria.asesoria.toLocaleString('es-ES')}‚Ç¨</span>
                                    </div>
                                    <div className="flex justify-between items-center p-3 bg-black/30 rounded-lg">
                                        <span className="text-gray-300">üè¢ Real Estate</span>
                                        <span className="font-bold text-blue-400">{data.ingresosPorCategoria.realEstate.toLocaleString('es-ES')}‚Ç¨</span>
                                    </div>
                                    <div className="flex justify-between items-center p-3 bg-black/30 rounded-lg">
                                        <span className="text-gray-300">üìä Inversiones</span>
                                        <span className={`font-bold ${data.ingresosPorCategoria.inversiones >= 0 ? 'text-green-400' : 'text-red-400'}`}>
                                            {data.ingresosPorCategoria.inversiones > 0 ? '+' : ''}
                                            {data.ingresosPorCategoria.inversiones.toLocaleString('es-ES')}‚Ç¨
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        {/* Muro de mensajes de la comunidad */}
                        <div className="bg-gradient-to-r from-purple-500/10 to-pink-500/10 border border-purple-500/30 rounded-xl p-6 mb-6">
                            <h3 className="text-lg font-bold text-purple-400 mb-4">üí¨ Mensajes de √Ånimo ({data.mensajes.length})</h3>
                            
                            <form onSubmit={handleNewMessage} className="mb-4">
                                <div className="flex gap-2">
                                    <input
                                        type="text"
                                        value={newMessage}
                                        onChange={(e) => setNewMessage(e.target.value)}
                                        placeholder="Deja un mensaje de √°nimo... üí™"
                                        maxLength={150}
                                        className="flex-1 bg-black/50 border border-purple-500/30 rounded px-3 py-2 text-sm text-white placeholder-gray-500 focus:outline-none focus:border-purple-400"
                                    />
                                    <button type="submit" className="bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-400 hover:to-pink-400 px-4 py-2 rounded font-semibold text-sm transition-all">
                                        Enviar
                                    </button>
                                </div>
                            </form>

                            <div className="space-y-2 max-h-64 overflow-y-auto">
                                {data.mensajes.length === 0 ? (
                                    <p className="text-center text-gray-500 py-8">S√© el primero en dejar un mensaje üí¨</p>
                                ) : (
                                    data.mensajes.slice(0, 10).map((msg) => (
                                        <div key={msg.id} className="bg-black/30 rounded-lg p-3 border border-purple-500/20 animate-slide-in">
                                            <div className="flex justify-between items-start mb-1">
                                                <span className="text-xs font-semibold text-purple-400">{msg.usuario}</span>
                                                <span className="text-xs text-gray-500">
                                                    {new Date(msg.fecha).toLocaleDateString('es-ES', { day: 'numeric', month: 'short', hour: '2-digit', minute: '2-digit' })}
                                                </span>
                                            </div>
                                            <p className="text-sm text-gray-300">{msg.texto}</p>
                                        </div>
                                    ))
                                )}
                            </div>
                        </div>

                        <div className="text-center text-xs text-gray-500">
                            <p>El Reto Dubai 100K - S√≠gueme en Instagram</p>
                            <p className="mt-1">Sistema autom√°tico: Durmiendo 23:00-07:00 (hora Dubai)</p>
                        </div>
                    </div>

                    {/* Panel Admin */}
                    {showAdmin && (
                        <div className="fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-4 overflow-y-auto">
                            <div className="bg-gradient-to-br from-slate-900 to-slate-800 border-2 border-cyan-500/50 rounded-xl max-w-2xl w-full my-8">
                                <div className="p-6">
                                    <div className="flex justify-between items-center mb-6">
                                        <h2 className="text-xl font-bold text-cyan-400">üéÆ Panel de Control</h2>
                                        <button onClick={() => { setShowAdmin(false); setIsAuthenticated(false); setAdminPassword(''); }} className="text-gray-400 hover:text-white text-2xl">‚úï</button>
                                    </div>

                                    {!isAuthenticated ? (
                                        <form onSubmit={handleAdminLogin} className="space-y-4">
                                            <div>
                                                <label className="block text-sm text-gray-300 mb-2">Contrase√±a</label>
                                                <input type="password" value={adminPassword} onChange={(e) => setAdminPassword(e.target.value)} className="w-full bg-black/50 border border-cyan-500/30 rounded px-3 py-2 text-white focus:outline-none focus:border-cyan-400" placeholder="Introduce la contrase√±a" />
                                            </div>
                                            <button type="submit" className="w-full bg-gradient-to-r from-cyan-500 to-blue-500 hover:from-cyan-400 hover:to-blue-400 px-4 py-3 rounded-lg font-semibold transition-all">Entrar</button>
                                        </form>
                                    ) : (
                                        <div className="space-y-6">
                                            <div className="bg-gradient-to-r from-purple-500/10 to-pink-500/10 border border-purple-500/30 rounded-lg p-4">
                                                <h3 className="text-lg font-bold text-purple-400 mb-4">üìç Cambiar Ubicaci√≥n</h3>
                                                <form onSubmit={handleActivityUpdate} className="space-y-4">
                                                    <div>
                                                        <label className="block text-sm text-gray-300 mb-2">¬øD√≥nde est√°s ahora?</label>
                                                        <select value={activityForm.location} onChange={(e) => setActivityForm({...activityForm, location: e.target.value})} className="w-full bg-black/50 border border-purple-500/30 rounded px-3 py-2 text-white focus:outline-none focus:border-purple-400">
                                                            {Object.values(LOCATIONS).map(loc => (
                                                                <option key={loc.id} value={loc.id}>{loc.name}</option>
                                                            ))}
                                                        </select>
                                                    </div>
                                                    <div>
                                                        <label className="block text-sm text-gray-300 mb-2">¬øQu√© est√°s haciendo?</label>
                                                        <input type="text" value={activityForm.activity} onChange={(e) => setActivityForm({...activityForm, activity: e.target.value})} className="w-full bg-black/50 border border-purple-500/30 rounded px-3 py-2 text-white focus:outline-none focus:border-purple-400" placeholder="Ej: Llamada con inversor..." maxLength={100} />
                                                    </div>
                                                    <button type="submit" className="w-full bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-400 hover:to-pink-400 px-4 py-3 rounded-lg font-semibold transition-all">Actualizar Ubicaci√≥n</button>
                                                </form>
                                            </div>

                                            <div className="bg-gradient-to-r from-green-500/10 to-emerald-500/10 border border-green-500/30 rounded-lg p-4">
                                                <h3 className="text-lg font-bold text-green-400 mb-4">üí∞ Actualizar Finanzas</h3>
                                                <form onSubmit={handleFinanceUpdate} className="space-y-4">
                                                    <div>
                                                        <label className="block text-sm text-gray-300 mb-2">Tipo</label>
                                                        <select value={financeForm.tipo} onChange={(e) => setFinanceForm({...financeForm, tipo: e.target.value})} className="w-full bg-black/50 border border-green-500/30 rounded px-3 py-2 text-white focus:outline-none focus:border-green-400">
                                                            <option value="ingreso">üí∞ Ingreso</option>
                                                            <option value="gasto">üí∏ Gasto</option>
                                                        </select>
                                                    </div>
                                                    {financeForm.tipo === 'ingreso' && (
                                                        <div>
                                                            <label className="block text-sm text-gray-300 mb-2">Categor√≠a</label>
                                                            <select value={financeForm.categoria} onChange={(e) => setFinanceForm({...financeForm, categoria: e.target.value})} className="w-full bg-black/50 border border-green-500/30 rounded px-3 py-2 text-white focus:outline-none focus:border-green-400">
                                                                <option value="asesoria">üíº Asesoramiento</option>
                                                                <option value="realEstate">üè¢ Real Estate</option>
                                                                <option value="inversiones">üìä Inversiones</option>
                                                            </select>
                                                        </div>
                                                    )}
                                                    <div>
                                                        <label className="block text-sm text-gray-300 mb-2">Monto (‚Ç¨)</label>
                                                        <input type="number" value={financeForm.monto} onChange={(e) => setFinanceForm({...financeForm, monto: e.target.value})} className="w-full bg-black/50 border border-green-500/30 rounded px-3 py-2 text-white focus:outline-none focus:border-green-400" placeholder="0.00" step="0.01" required />
                                                    </div>
                                                    <div>
                                                        <label className="block text-sm text-gray-300 mb-2">Nota</label>
                                                        <textarea value={financeForm.nota} onChange={(e) => setFinanceForm({...financeForm, nota: e.target.value})} className="w-full bg-black/50 border border-green-500/30 rounded px-3 py-2 text-white focus:outline-none focus:border-green-400" placeholder="Describe..." rows="3" maxLength={200} />
                                                    </div>
                                                    <button type="submit" className="w-full bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-400 hover:to-emerald-400 px-4 py-3 rounded-lg font-semibold transition-all">Guardar</button>
                                                </form>
                                            </div>

                                            <div className="bg-black/30 border border-cyan-500/30 rounded-lg p-4">
                                                <h3 className="text-sm font-semibold text-cyan-400 mb-2">üìä Resumen</h3>
                                                <div className="grid grid-cols-2 gap-2 text-sm">
                                                    <div>Total Ingresos:</div>
                                                    <div className="text-green-400 font-semibold text-right">{data.totalIngresos.toLocaleString('es-ES')}‚Ç¨</div>
                                                    <div>Total Gastos:</div>
                                                    <div className="text-red-400 font-semibold text-right">{data.totalGastos.toLocaleString('es-ES')}‚Ç¨</div>
                                                    <div>Actualizaciones:</div>
                                                    <div className="text-cyan-400 font-semibold text-right">{data.actualizaciones.length}</div>
                                                    <div>Mensajes:</div>
                                                    <div className="text-purple-400 font-semibold text-right">{data.mensajes.length}</div>
                                                    <div>Ubicaci√≥n:</div>
                                                    <div className="text-orange-400 font-semibold text-right">{LOCATIONS[data.currentLocation].name}</div>
                                                </div>
                                            </div>
                                        </div>
                                    )}
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        ReactDOM.render(<SimsApp />, document.getElementById('root'));
    </script>
</body>
</html>
